document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("filter_tags_search"),r=document.getElementById("filter_tags_datalist"),d=document.getElementById("filter_tags_list"),o=document.getElementById("filter_tags_hidden"),s=document.getElementById("filter_tags_add");if(!n||!r||!d||!o||!s)return;const l=()=>{const t=Array.from(d.querySelectorAll("li")).map(e=>e.dataset.id??"");o.value=t.join(",")},c=()=>{const t=n.value.trim();if(!t)return;const e=Array.from(r.options).find(u=>u.value.toLowerCase()===t.toLowerCase());if(!e){n.value="";return}const i=e.dataset.id;if(!i||d.querySelector(`li[data-id="${i}"]`))return;const a=document.createElement("li");a.textContent=`${t} âœ•`,a.dataset.id=i,a.style.cssText="display:inline-block;margin:2px 4px 2px 0;padding:4px 8px;background:#f0f0f0;border-radius:4px;cursor:pointer;",d.appendChild(a),n.value="",l()};s.addEventListener("click",c),n.addEventListener("keydown",t=>{t.key==="Enter"&&(t.preventDefault(),c())}),d.addEventListener("click",t=>{const e=t.target;e.tagName==="LI"&&(e.remove(),l())})});
